<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Análisis de datos - 5&nbsp; Escalamiento multidimensional (MDS)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./ACP.html" rel="prev">
<link href="./atlas.jpeg" rel="icon" type="image/jpeg">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./MDS.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Escalamiento multidimensional (MDS)</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análisis de datos</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/AprendeR-UIB/AD/Enlaces" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo lector">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presentación</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción al Análisis de Datos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./EM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Análisis Multivariante</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Inferencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Inferencia multivariante en poblaciones normales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ACP.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Análisis de Componentes Principales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./MDS.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Escalamiento multidimensional (MDS)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#introducción" id="toc-introducción" class="nav-link active" data-scroll-target="#introducción"><span class="header-section-number">5.1</span> Introducción</a></li>
  <li><a href="#reconstrucción-de-las-variables-a-partir-de-las-distancias-entre-puntos" id="toc-reconstrucción-de-las-variables-a-partir-de-las-distancias-entre-puntos" class="nav-link" data-scroll-target="#reconstrucción-de-las-variables-a-partir-de-las-distancias-entre-puntos"><span class="header-section-number">5.2</span> Reconstrucción de las variables a partir de las distancias entre puntos</a></li>
  <li><a href="#construcción-de-las-coordenadas-principales" id="toc-construcción-de-las-coordenadas-principales" class="nav-link" data-scroll-target="#construcción-de-las-coordenadas-principales"><span class="header-section-number">5.3</span> Construcción de las coordenadas principales</a></li>
  <li><a href="#ejemplo-a-mano" id="toc-ejemplo-a-mano" class="nav-link" data-scroll-target="#ejemplo-a-mano"><span class="header-section-number">5.4</span> Ejemplo a mano</a></li>
  <li><a href="#mds-no-métrico" id="toc-mds-no-métrico" class="nav-link" data-scroll-target="#mds-no-métrico"><span class="header-section-number">5.5</span> MDS no métrico</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">5.6</span> </a></li>
  <li><a href="#ejemplos-en-r" id="toc-ejemplos-en-r" class="nav-link" data-scroll-target="#ejemplos-en-r"><span class="header-section-number">5.7</span> Ejemplos en R</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/AprendeR-UIB/AD/Enlaces/edit/main/MDS.qmd" class="toc-action">Editar esta página</a></p><p><a href="https://github.com/AprendeR-UIB/AD/Enlaces/issues/new" class="toc-action">Informar de un problema</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Escalamiento multidimensional (MDS)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introducción" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="introducción"><span class="header-section-number">5.1</span> Introducción</h2>
<p>Las técnicas de escalado multidimensional son una generalización de la idea de componentes principales cuando en lugar de disponer de una matriz de observaciones por variables, como en componentes principales, se dispone de una matriz, <span class="math inline">\(\mathbf{D}\)</span>, cuadrada <span class="math inline">\(n \times n\)</span> de distancias o disimilaridades entre los <span class="math inline">\(n\)</span> elementos de un conjunto.</p>
<p>Estas distancias pueden haberse obtenido a partir de ciertas variables, o pueden ser el resultado de una estimación directa, por ejemplo preguntando a un grupo de evaluadores por sus opiniones sobre las similaridades entre los elementos considerados.</p>
<p>El objetivo del <span class="math inline">\(MDS\)</span> es representar las distancias observadas mediante unas variables <span class="math inline">\(y_1,\dots, y_k\)</span>, donde <span class="math inline">\(k &lt; n\)</span>, tales que las distancias Euclídeas entre las coordenadas de los elementos respecto a estas variables sean iguales (o lo más próximas posibles) a las distancias o disimilaridades de la matriz partida. De esta manera, la representación gráfica en <span class="math inline">\(k\)</span> dimensiones será una reproducción fiel de la estructura observada.</p>
<p>El escalado multidimensional comparte con componentes principales el objetivo de describir e interpretar los datos. Si existen muchos elementos, la matriz de similaridades será muy grande y la representación por unas pocas variables de los elementos nos permitirá entender su estructura: qué elementos tienen propiedades similares, si aparecen grupos entre los elementos, si hay elementos atípicos, etc.</p>
<p>El escalado multidimensional representa un enfoque complementario a componentes principales en el sentido siguiente.</p>
<ul>
<li><p>Componentes principales considera la matriz <span class="math inline">\(p \times p\)</span> de correlaciones (o covarianzas) entre variables, e investiga su estructura.</p></li>
<li><p>El escalado multidimensional considera la matriz <span class="math inline">\(n \times n\)</span> de correlaciones (o covarianzas) entre individuos, e investiga su estructura. Los métodos existentes se dividen en métricos, cuando la matriz inicial es propiamente de distancias, y no métricos, cuando la matriz es de similaridades.</p></li>
</ul>
<p>Los métodos métricos, utilizan las diferencias entre similitudes mientras que los no métricos parten de que si <span class="math inline">\(A\)</span> es más similar a <span class="math inline">\(B\)</span> que a <span class="math inline">\(C\)</span>, entonces <span class="math inline">\(A\)</span> esta más cerca de <span class="math inline">\(B\)</span> que de <span class="math inline">\(C\)</span>, pero las diferencias entre las similitudes <span class="math inline">\(AB\)</span> y <span class="math inline">\(AC\)</span> no tienen interpretación.</p>
</section>
<section id="reconstrucción-de-las-variables-a-partir-de-las-distancias-entre-puntos" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="reconstrucción-de-las-variables-a-partir-de-las-distancias-entre-puntos"><span class="header-section-number">5.2</span> Reconstrucción de las variables a partir de las distancias entre puntos</h2>
<p>Dado un conjunto <span class="math inline">\(p\)</span> de variables en <span class="math inline">\(n\)</span> individuos representados en la matriz <span class="math inline">\(\mathbf{X}_{n \times p}\)</span>, podemos construir dos tipos de matrices cuadradas y semidefinidas positivas: la matriz de covarianzas muestral <span class="math inline">\(\mathbf{S}\)</span> (definida por <span class="math inline">\(\frac{1}{n}\mathbf{X}^t \mathbf{X}\)</span>), si las variables tienen media cero, y la matriz de productos cruzados <span class="math inline">\(\mathbf{Q} = \mathbf{XX}^t\)</span>.</p>
<p>El <span class="math inline">\(MDS\)</span> puede verse como un análisis de la matriz <span class="math inline">\(\mathbf{Q}\)</span> y esta puede interpretarse como una matriz de similitudes entre las observaciones ya que sus términos, <span class="math inline">\(q_{ij}\)</span>, contienen el producto escalar de las observaciones de dos elementos dados: <span class="math display">\[q_{ij} = \sum_{p=1}^k x_{ip}x_{jp} = \mathbf{x}_i^t \mathbf{x}_j \;\; \;\;  \; (1)\]</span> En efecto, como <span class="math inline">\(q_{ij}=|\mathbf{x}_i||\mathbf{x}_j|\cos \theta_{ij}\)</span>, si los dos elementos tienen coordenadas similares, <span class="math inline">\(\cos \theta_{ij}\approx 1\)</span> y <span class="math inline">\(q_{ij}\)</span> será grande. Por el contrario, si los dos elementos tienen valores distintos <span class="math inline">\(\cos \theta_{ij}\approx 0\)</span> y <span class="math inline">\(q_{ij}\)</span> será pequeño.</p>
<p>La distancia Euclídea al cuadrado entre dos elementos se define por:</p>
<p><span class="math display">\[d^2_{ij}=\sum_{p=1}^k (x_{ip}-x_{jp})^2=\sum_{p}x_{ip}^2+\sum_{p}x_{jp}^2-2\sum_{p}x_{ip}x_{jp}\]</span> y la podemos escribir en función de los términos de la matriz <span class="math inline">\(\mathbf{Q}\)</span>,</p>
<p><span class="math display">\[d^2_{ij}=q_{ii}+q_{jj}-2q_{ij} \;\; \;\;  \; (2)\]</span></p>
<p>Por tanto, dada la matriz <span class="math inline">\(\mathbf{X}\)</span> podemos construir la matriz <span class="math inline">\(\mathbf{Q}\)</span> y a partir de esta matriz es fácil obtener la matriz de distancias al cuadrado con ayuda de las expresiones (1) y (2).</p>
<p>El problema que se aborda en MDS es el inverso: dada una matriz de distancias al cuadrado, <span class="math inline">\(\mathbf{D}\)</span>, con elementos <span class="math inline">\(d^2_{ij}\)</span> se trata de reconstruir la matrix <span class="math inline">\(\mathbf{X}\)</span>.</p>
<p>Lo primero que se plantea es obtener la matriz <span class="math inline">\(\mathbf{Q}\)</span> dada la matriz <span class="math inline">\(\mathbf{D}\)</span>. Para ello, observemos, que sin pérdida de generalidad, siempre podemos suponer que las variables <span class="math inline">\(X\)</span> tienen media cero. En efecto, las distancias entre los puntos, <span class="math inline">\(d^2_{ij}\)</span> no varían si expresamos las variables en desviaciones a la media, ya que:</p>
<p><span class="math display">\[d^2_{ij}=\sum_{p=1}^k (x_{ip}-x_{jp})^2=\sum_{p}\left[ (x_{ip}-\bar{x}_p)-(x_{jp}-\bar{x}_p) \right]^2 \;\; \;\;  \; (3)\]</span> y, por tanto, podemos suponer siempre que las variables que buscamos tienen media cero.</p>
<p>Por ello, como resulta que <span class="math inline">\(\mathbf{X}^t \mathbf{1} = 0\)</span> se debe verificar que <span class="math inline">\(\mathbf{Q}\mathbf{1} = 0\)</span>, es decir, la suma de todos los elementos de una fila de la matriz <span class="math inline">\(\mathbf{Q}\)</span> (y de una columna ya que la matriz es simétrica) debe de ser cero.</p>
<p>Luego, sumamos en (2) por filas: <span class="math display">\[\sum_{i=1}^n d^2_{ij}=\sum_{i=1}^n q_{ii}+nq_{jj}=t+nq_{jj} \;\; \;\;  \; (4)\]</span> donde <span class="math inline">\(t=\sum_{i=1}^n q_{ii}=traza(\mathbf{Q})\)</span>, y sabiendo que <span class="math inline">\(\sum_{i=1}^n q_{ij}=0\)</span>.</p>
<p>Sumando (2) por columnas se tiene: <span class="math display">\[\sum_{j=1}^n d^2_{ij}=n q_{ii}+t \;\; \;\;  \; (5)\]</span> y sumando ahora (4) por filas de nuevo se tiene:</p>
<p><span class="math display">\[\sum_{i=1}^n \sum_{j=1}^n d^2_{ij}=2nt\]</span></p>
<p>Sustituyendo (4) y (5) en (2), tenemos que</p>
<p><span class="math display">\[d^2_{ij}=\frac{1}{n}\sum_{p=1}^k d^2_{ij} - \frac{t}{n} + \frac{1}{n}\sum_{p=1}^k d^2_{ij} - \frac{t}{n} -2 q_{ij},  \]</span> y llamando <span class="math inline">\(d^2_{i.}\)</span> y <span class="math inline">\(d^2_{.j}\)</span> a las medias por filas y por columnas y utilizando (5), tenemos que</p>
<p><span class="math display">\[ d^2_{ij}= d^2_{i.}+ d^2_{.j}-d^2_{..}-2 q_{ij} \;\; \;\;  \; (6) \]</span> donde <span class="math inline">\(d^2_{..}=\frac{1}{n^2}\sum_{i=1}^n \sum_{j=1}^n d^2_{ij}\)</span></p>
<p>Finalmente, despejando de (6) resulta que <span class="math display">\[q_{ij}=-\frac{1}{2}\left( d^2_{ij}-d^2_{i.}-d^2_{.j}+d^2_{..}\right)\]</span> expresión que indica cómo construir la matriz <span class="math inline">\(\mathbf{Q}\)</span> a partir de la matriz de distancias <span class="math inline">\(\mathbf{D}\)</span>.</p>
<p>De una manera equivalente, se puede obtener la matriz <span class="math inline">\(\mathbf{X}\)</span> a partir de la matriz <span class="math inline">\(\mathbf{Q}\)</span>. Si ésta es definida positiva de rango <span class="math inline">\(k\)</span> entonces puede expresarse por <span class="math display">\[\mathbf{Q}=\mathbf{V} \mathbf{\Lambda}\mathbf{V}^t\]</span> donde <span class="math inline">\(\mathbf{V}\)</span> es una matriz <span class="math inline">\(n \times k\)</span> y <span class="math inline">\(\mathbf{\Lambda}\)</span> es una matriz diagonal <span class="math inline">\(k \times k\)</span> y contiene los vectores propios no nulos de <span class="math inline">\(\mathbf{Q}\)</span>. Entonces, podemos escribir <span class="math display">\[\mathbf{Q}=\left(\mathbf{V} \mathbf{\Lambda}^{1/2} \right) \left( \mathbf{\Lambda}^{1/2} \mathbf{V}^t \right)\]</span> y tomando</p>
<p><span class="math display">\[\mathbf{Y}=\mathbf{V}\mathbf{\Lambda}^{1/2}\]</span> se obtienen <span class="math inline">\(k\)</span> variables incorreladas que reproducen la métrica.</p>
<p>Observa que las variables <span class="math inline">\(\mathbf{Y}\)</span> no son las variables originales <span class="math inline">\(\mathbf{X}\)</span>, sino sus componentes principales.</p>
</section>
<section id="construcción-de-las-coordenadas-principales" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="construcción-de-las-coordenadas-principales"><span class="header-section-number">5.3</span> Construcción de las coordenadas principales</h2>
<p>En general, la matriz de disimilaridades o distancias no será compatible con una métrica Euclídea, pero es frecuente que la matriz <span class="math inline">\(\mathbf{Q}\)</span> tenga <span class="math inline">\(k\)</span> valores propios positivos y más grandes que el resto.</p>
<p>Si los restantes <span class="math inline">\(n-k\)</span> valores propios no nulos son mucho menores que los demás, podemos obtener una representación aproximada de los puntos utilizando los <span class="math inline">\(k\)</span> vectores propios asociados a valores propios positivos. En este caso, las representaciones gráficas conservarán aproximadamente la distancia entre los puntos.</p>
<p>El procedimiento para obtener las coordenadas principales es el siguiente:</p>
<p>1.- Formar la matriz de distancias al cuadrado, <span class="math inline">\(\mathbf{D}\)</span>, cuyos elementos son los cuadrados de las distancias.</p>
<p>2.- Construir la matriz <span class="math inline">\(\mathbf{Q}\)</span> de productos cruzados.</p>
<p>3.- Obtener los valores y vectores propios de <span class="math inline">\(\mathbf{Q}\)</span>. Tomar los <span class="math inline">\(k\)</span> mayores si podemos suponer que los restantes <span class="math inline">\(n \times k\)</span> son próximos a cero.</p>
<p>4.- Obtener las coordenadas de los puntos en las variables mediante <span class="math inline">\(\sqrt{{\lambda_i}} \mathbf{v}_i\)</span>, donde <span class="math inline">\(\mathbf{\lambda}_i\)</span> es el valor propio y <span class="math inline">\(\mathbf{v}_i\)</span> el vector propio.</p>
<p>El método puede aplicarse también cuando la matriz de partida <span class="math inline">\(\mathbf{Q}\)</span> es una matriz de similaridades cualquiera. Entonces <span class="math inline">\(q_{ii}=1\)</span>, <span class="math inline">\(q_{ij}=q_{ji}\)</span> y <span class="math inline">\(0 \leq q_{ij} \leq 1\)</span>. De acuerdo a (2), la matriz de distancias asociadas será: <span class="math display">\[d^2_{ij}= q_{ii}+ q_{jj}-2 q_{ij}=2(1-q_{ij})\]</span> y puede comprobarse que <span class="math inline">\(\sqrt{2(1-q_{ij})}\)</span> es una distancia y verifica la desigualdad triangular al corresponder a la distancia euclídea para cierta configuración de puntos.</p>
<p>Se ha propuesto como medida de la precisión en la aproximación mediante los <span class="math inline">\(k\)</span> valores propios positivos, los coeficientes:</p>
<p><span class="math display">\[m_{1,K}=\frac{\sum_{i=1}^K |\lambda_i|}{\sum_{i=1}^p |\lambda_i|} \cdot 100\]</span> ó</p>
<p><span class="math display">\[m_{2,K}=\frac{\sum_{i=1}^K \lambda_i^2}{\sum_{i=1}^p \lambda_i^2} \cdot 100\]</span></p>
</section>
<section id="ejemplo-a-mano" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="ejemplo-a-mano"><span class="header-section-number">5.4</span> Ejemplo a mano</h2>
<p>Sobre el siguiente conjunto de animales $={león, jirafa, vaca, oveja, gato, hombre } $ se han medido las siguientes variables binarias:</p>
<ul>
<li><p><span class="math inline">\(X_1\)</span>: ¿tiene cola?</p></li>
<li><p><span class="math inline">\(X_2\)</span>: ¿es salvaje?</p></li>
<li><p><span class="math inline">\(X_3\)</span>: ¿tiene el cuello largo?</p></li>
<li><p><span class="math inline">\(X_4\)</span>: ¿es animal de granja?</p></li>
<li><p><span class="math inline">\(X_5\)</span>: ¿es carnívoro?</p></li>
<li><p><span class="math inline">\(X_6\)</span>: ¿camina sobre cuatro patas?</p></li>
</ul>
<p>La matriz de datos es :</p>
<p><span class="math display">\[\mathbf{X}=\begin{pmatrix}
1 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 1\\
1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
\end{pmatrix}= \begin{matrix}
león\\
jirafa \\
vaca \\
oveja \\
gato \\
hombre
\end{matrix}\]</span></p>
<p>A partir de esta matriz, construye las coordenadas principales y realiza una representación en 2 dimensiones. Calcula una medida de precisión de la representación que has realizado.</p>
<p>En este caso tenemos <span class="math inline">\(\mathbf{X}\)</span>, si no fuese el caso habría que usar una medida de similiaridad como por ejemplo la de Sokal y Mikener (<strong>Ejercicio</strong>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">nrow=</span><span class="dv">6</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    1    0    0    1    1
[2,]    1    1    1    0    0    1
[3,]    1    0    0    1    0    1
[4,]    1    0    0    1    0    1
[5,]    1    0    0    0    1    1
[6,]    0    0    0    0    1    0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Q<span class="ot">=</span>X <span class="sc">%*%</span> <span class="fu">t</span>(X)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>valores<span class="ot">=</span><span class="fu">eigen</span>(Q)<span class="sc">$</span>values</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>vectores<span class="ot">=</span><span class="fu">eigen</span>(Q)<span class="sc">$</span>vectors</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">=</span><span class="fu">sqrt</span>(valores[<span class="dv">1</span>])<span class="sc">*</span>vectores[,<span class="dv">1</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">=</span><span class="fu">sqrt</span>(valores[<span class="dv">2</span>])<span class="sc">*</span>vectores[,<span class="dv">2</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculamos una medida de precisión (variabilidad explicada) con 2 componentes y miramos la representación</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">m_12=</span>(<span class="fu">sum</span>(<span class="fu">abs</span>(valores[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]))<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">abs</span>(valores)))<span class="sc">*</span><span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86.20502</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">m_22=</span>(<span class="fu">sum</span>(valores[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sum</span>(valores<span class="sc">^</span><span class="dv">2</span>))<span class="sc">*</span><span class="dv">100</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 97.63187</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="MDS_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mds-no-métrico" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="mds-no-métrico"><span class="header-section-number">5.5</span> MDS no métrico</h2>
<p>Partiendo de la matriz de disimilaridades <span class="math inline">\(\mathbf{\Lambda}=(\delta_{ij})\)</span>, el Escalado no métrico consiste en encontrar unas coordenadas, cuyas distancias euclídeas al cuadrado mantengan el órden de las disimilaridades. Es decir, <strong>el Escalado no métrico solo tiene en cuenta la información referente al órden entre las disimilaridades, y no su magnitud</strong>. El procedimiento es el siguiente:</p>
<ol type="1">
<li><p>Se calculan unas coordenadas iniciales <span class="math inline">\(Z^{(0)}\)</span>, por ejemplo aplicando MDS métrico a <span class="math inline">\(\mathbf{\Lambda}\)</span>. Esto es, calcular <span class="math inline">\(\mathbf{Q}\)</span>, realizar la descomposición <span class="math inline">\(\mathbf{Q}=\mathbf{V} \mathbf{\Lambda}\mathbf{V}^t\)</span> y tomar <span class="math inline">\(Z^{(0)} =\mathbf{V}_K \mathbf{\Lambda}_K^{1/2}\)</span>, donde <span class="math inline">\(\mathbf{\Lambda}_K\)</span> contiene los <span class="math inline">\(k\)</span> valores propios mayores y sus <span class="math inline">\(\mathbf{V}_K\)</span> vectores propios asociados en columnas. Así, obtenemos <span class="math inline">\(D^{(0)}=(d^{(0)}_{ij})\)</span> a partir de las coordenadas <span class="math inline">\(Z^{(0)}\)</span>.</p></li>
<li><p>Se calculan disparidades <span class="math inline">\(\hat{d}_{ij}\)</span> que son una transformación de las distancias <span class="math inline">\(d_{ij}\)</span> que mantienen la misma ordenación que las disimilaridades <span class="math inline">\(\delta_{ij}\)</span>, es decir <span class="math display">\[\hat{d}_{ij}=f(d_{ij})\]</span> donde <span class="math inline">\(f\)</span> es una función monótona que verifica: Si <span class="math inline">\(\delta_{ij} \leq \delta_{kl}\)</span>, entonces <span class="math inline">\(\hat{d}_{ij} \leq \hat{d}_{kl}\)</span>.</p></li>
</ol>
<p><span style="color: blue;"><em>Ejemplo:</em></span>: Consideremos la matriz de disimilaridades <span class="math display">\[\mathbf{\Lambda}=(\delta_{ij})=\begin{pmatrix}
0 &amp; 2.1 &amp; 3 &amp; 2.4\\
  &amp; 0  &amp;  1.7 &amp; 3.9 \\
  &amp;    &amp;  0  &amp; 3.2 \\
  &amp;    &amp;     &amp; 0
\end{pmatrix} \]</span></p>
<p>Supongamos que hemos obtenido una matriz de coordenadas inicial <span class="math inline">\(Z^{(0)}\)</span>, cuya matriz de distancias es <span class="math display">\[D^{(0)}=(d^{(0)}_{ij})=\begin{pmatrix}
0 &amp; 1.6 &amp; 4.5 &amp; 5.7\\
  &amp; 0  &amp;  3.3 &amp; 4.3 \\
  &amp;    &amp;  0  &amp; 1.3 \\
  &amp;    &amp;     &amp; 0
\end{pmatrix}\]</span></p>
<p>Obtener las disparidades:</p>
<p>Escribimos las disimilaridades en órden creciente <span class="math display">\[\delta_{23}=1.7, \delta_{12}=2.1, \delta_{14}=2.4, \delta_{13}=3, \delta_{34}=3.2, \delta_{24}=3.9\]</span></p>
<p>Ahora escribimos las distancias correspondientes <span class="math display">\[d_{23}= \ldots, d_{12}= \ldots, d_{14}= \ldots, d_{13}= \ldots, d_{34}= \ldots, d_{24}= \ldots\]</span></p>
<p>Si mantuviesen el mismo órden que las disimilaridades, estarían ordenadas de menor a mayor, y en ese caso, las disparidades serían iguales a las distancias. Entonces <span class="math inline">\(Z^{(0)}\)</span> sería una solución válida.</p>
<p>Una transformación monótona de estas distancias que preserva el órden de las disimilaridades se calcula de la siguiente forma: cuando existe una secuencia de distancias que están ordenadas al contrario de lo deseado, se reemplazan todas estas distancias por la media de las distancias de dicha secuencia. Así, las disparidades son:</p>
<p><span class="math display">\[\begin{align*}
\hat{d}_{23} &amp;= \hat{d}_{12}=\frac{1}{2} (d_{23}+d_{12}), \\
\hat{d}_{14} &amp;= \hat{d}_{13}=\hat{d}_{34}=\frac{1}{3} (d_{14}+d_{13}+d_{34}), \\
\hat{d}_{24} &amp;= d_{24}
\end{align*}\]</span></p>
<p>Para medir la bondad de ajuste de la solución obtenida:</p>
<ul>
<li><p><strong>STRESS</strong>: <span class="math inline">\(S= \left[\frac{\sum_{i&lt;j} (d_{ij}-\hat{d}_{ij})^2}{\sum_{i&lt;j}d^2_{ij}} \right]^{1/2}\)</span></p>
<ul>
<li><span class="math inline">\(S \in (0, 0.01] \implies\)</span> Solución muy buena;</li>
<li><span class="math inline">\(S \in (0.01, 0.05] \implies\)</span> Solución buena;</li>
<li><span class="math inline">\(S \in (0.05, 0.1] \implies\)</span> Solución aceptable.</li>
</ul></li>
<li><p><strong>S-STRESS</strong>: <span class="math inline">\(S= \left[\frac{\sum_{i&lt;j} (d_{ij}-\hat{d}_{ij})^2}{\sum_{i&lt;j}d^4_{ij}} \right]^{1/2}\)</span></p></li>
</ul>
<p>Esta medida está entre 0 y 1, siendo valores cercanos a cero indicadores de un buen ajuste, y valores cercanos a 1 indicadores de un mal ajuste.</p>
<ul>
<li><strong>RSQ</strong>: Es el coeficiente de correlación al cuadrado entre las distancias y las disparidades. El ajuste es aceptable para RSQ <span class="math inline">\(\geq 0.6\)</span>.</li>
</ul>
</section>
<section id="section" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="section"><span class="header-section-number">5.6</span> </h2>
<p>Si para las coordenadas actuales, estas medidas no son satisfactorias, entonces pasamos a la búsqueda de una nueva solución. Esta solución se busca minimizando una de las medidas de ajuste respecto a las coordenadas, generalmente se utiliza el STRESS o el S-STRESS.</p>
<p><strong>Minimización del STRESS</strong></p>
<p>Sea <span class="math inline">\(\mathbf{z}=(\mathbf{z}^t_1, \ldots, \mathbf{z}^t_n)\)</span> el vector formado por las <span class="math inline">\(n\)</span> filas de <span class="math inline">\(\mathbf(Z)\)</span> (nuestras incógnitas). El problema es encontrar <span class="math inline">\(\mathbf{z}\)</span> que minimice <span class="math display">\[S= \left[\frac{\sum_{i&lt;j} (d_{ij}(\mathbf{z})-\hat{d}_{ij})^2}{\sum_{i&lt;j}d^2_{ij}(\mathbf{z})} \right]^{1/2}\]</span> donde <span class="math display">\[d^2_{ij}(\mathbf{z})=d^2_e(\mathbf{z}_i,\mathbf{z}_j)=\sum_{k=1}^p (z_{ik}-z_{jk})^2.\]</span> Este problema es no lineal, con lo cual es necesario recurrir a métodos de resolución numéricos.</p>
</section>
<section id="ejemplos-en-r" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="ejemplos-en-r"><span class="header-section-number">5.7</span> Ejemplos en R</h2>
<ul>
<li><p>Con R base:</p>
<p>https://www.statmethods.net/advstats/mds.html</p></li>
<li><p>Con tidyverse</p>
<p>http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/122-multidimensional-scaling-essentials-algorithms-and-r-code/</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ACP.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Análisis de Componentes Principales</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Análisis de Datos UIB</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Este libro se ha creado con <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>